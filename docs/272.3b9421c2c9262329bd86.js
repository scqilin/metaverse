"use strict";(self.webpackChunkmetaverse=self.webpackChunkmetaverse||[]).push([[272],{1272:(Gs,bt,ae)=>{ae.r(bt),ae.d(bt,{DaysModule:()=>Ns});var yn=ae(8583),He=ae(931),g=ae(639);const _n=["audio"];let xn=(()=>{class t{constructor(){this.title="Metaverse"}ngOnInit(){}ngAfterViewInit(){}onClick(){var n;null===(n=this.audio.nativeElement)||void 0===n||n.play()}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-days"]],viewQuery:function(n,s){if(1&n&&g.Gf(_n,5),2&n){let i;g.iGM(i=g.CRH())&&(s.audio=i.first)}},decls:27,vars:1,consts:[[1,"com"],[2,"text-align","center","width","100%","position","absolute"],[1,"lia",2,"position","absolute","top","20px","left","10px",3,"click"],["mat-raised-button","","routerLink","./m1"],["mat-raised-button","","routerLink","./m2"],["mat-raised-button","","routerLink","./m3"],["mat-raised-button","","routerLink","./m4"],["mat-raised-button","","routerLink","./m5"],["mat-raised-button","","routerLink","./m6"],["loop","loop"],["audio",""],["src","assets/sound/forestEnvironment.mp3","type","audio/mp3"]],template:function(n,s){1&n&&(g.TgZ(0,"div",0),g.TgZ(1,"div",1),g.TgZ(2,"h1"),g._uU(3),g.qZA(),g.qZA(),g.TgZ(4,"div",2),g.NdJ("click",function(){return s.onClick()}),g.TgZ(5,"li"),g.TgZ(6,"a",3),g._uU(7,"Day1"),g.qZA(),g.qZA(),g.TgZ(8,"li"),g.TgZ(9,"a",4),g._uU(10,"Day2"),g.qZA(),g.qZA(),g.TgZ(11,"li"),g.TgZ(12,"a",5),g._uU(13,"Day3"),g.qZA(),g.qZA(),g.TgZ(14,"li"),g.TgZ(15,"a",6),g._uU(16,"Day4"),g.qZA(),g.qZA(),g.TgZ(17,"li"),g.TgZ(18,"a",7),g._uU(19,"Day5"),g.qZA(),g.qZA(),g.TgZ(20,"li"),g.TgZ(21,"a",8),g._uU(22,"Day6"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g._UZ(23,"router-outlet"),g.TgZ(24,"audio",9,10),g._UZ(26,"source",11),g.qZA()),2&n&&(g.xp6(3),g.hij(" Welcome to ",s.title,"! "))},directives:[He.yS,He.lC],styles:[".com[_ngcontent-%COMP%]{position:absolute;color:#eee;width:100%}.lia[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style-type:none;padding:5px}"]}),t})();var u=ae(7758),Re=ae(2834);class St extends u.aNw{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(n){return new bn(n)}),this.register(function(n){return new Ln(n)}),this.register(function(n){return new kn(n)}),this.register(function(n){return new Sn(n)}),this.register(function(n){return new En(n)}),this.register(function(n){return new Rn(n)}),this.register(function(n){return new In(n)}),this.register(function(n){return new Cn(n)}),this.register(function(n){return new Tn(n)}),this.register(function(n){return new On(n)})}load(e,n,s,i){const r=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:u.Zp0.extractUrlBase(e),this.manager.itemStart(e);const c=function(l){i?i(l):console.error(l),r.manager.itemError(e),r.manager.itemEnd(e)},a=new u.hH6(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){try{r.parse(l,o,function(f){n(f),r.manager.itemEnd(e)},c)}catch(f){c(f)}},s,c)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,n,s,i){let r;const o={},c={};if("string"==typeof e)r=e;else if(u.Zp0.decodeText(new Uint8Array(e,0,4))===Et){try{o[O.KHR_BINARY_GLTF]=new Un(e)}catch(h){return void(i&&i(h))}r=o[O.KHR_BINARY_GLTF].content}else r=u.Zp0.decodeText(new Uint8Array(e));const a=JSON.parse(r);if(void 0===a.asset||a.asset.version[0]<2)return void(i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new $n(a,{path:n||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let f=0;f<this.pluginCallbacks.length;f++){const h=this.pluginCallbacks[f](l);c[h.name]=h,o[h.name]=!0}if(a.extensionsUsed)for(let f=0;f<a.extensionsUsed.length;++f){const h=a.extensionsUsed[f],d=a.extensionsRequired||[];switch(h){case O.KHR_MATERIALS_UNLIT:o[h]=new An;break;case O.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:o[h]=new Fn;break;case O.KHR_DRACO_MESH_COMPRESSION:o[h]=new Pn(a,this.dracoLoader);break;case O.KHR_TEXTURE_TRANSFORM:o[h]=new Dn;break;case O.KHR_MESH_QUANTIZATION:o[h]=new zn;break;default:d.indexOf(h)>=0&&void 0===c[h]&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}l.setExtensions(o),l.setPlugins(c),l.parse(s,i)}parseAsync(e,n){const s=this;return new Promise(function(i,r){s.parse(e,n,i,r)})}}function Mn(){let t={};return{get:function(e){return t[e]},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},removeAll:function(){t={}}}}const O={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class Tn{constructor(e){this.parser=e,this.name=O.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,n=this.parser.json.nodes||[];for(let s=0,i=n.length;s<i;s++){const r=n[s];r.extensions&&r.extensions[this.name]&&void 0!==r.extensions[this.name].light&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const n=this.parser,s="light:"+e;let i=n.cache.get(s);if(i)return i;const r=n.json,a=((r.extensions&&r.extensions[this.name]||{}).lights||[])[e];let l;const f=new u.Ilk(16777215);void 0!==a.color&&f.fromArray(a.color);const h=void 0!==a.range?a.range:0;switch(a.type){case"directional":l=new u.Ox3(f),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new u.cek(f),l.distance=h;break;case"spot":l=new u.PMe(f),l.distance=h,a.spot=a.spot||{},a.spot.innerConeAngle=void 0!==a.spot.innerConeAngle?a.spot.innerConeAngle:0,a.spot.outerConeAngle=void 0!==a.spot.outerConeAngle?a.spot.outerConeAngle:Math.PI/4,l.angle=a.spot.outerConeAngle,l.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return l.position.set(0,0,0),l.decay=2,void 0!==a.intensity&&(l.intensity=a.intensity),l.name=n.createUniqueName(a.name||"light_"+e),i=Promise.resolve(l),n.cache.add(s,i),i}createNodeAttachment(e){const n=this,s=this.parser,r=s.json.nodes[e],c=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===c?null:this._loadLight(c).then(function(a){return s._getNodeRef(n.cache,c,a)})}}class An{constructor(){this.name=O.KHR_MATERIALS_UNLIT}getMaterialType(){return u.vBJ}extendParams(e,n,s){const i=[];e.color=new u.Ilk(1,1,1),e.opacity=1;const r=n.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const o=r.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==r.baseColorTexture&&i.push(s.assignTexture(e,"map",r.baseColorTexture))}return Promise.all(i)}}class bn{constructor(e){this.parser=e,this.name=O.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const s=this.parser.json.materials[e];return s.extensions&&s.extensions[this.name]?u.EJi:null}extendMaterialParams(e,n){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],o=i.extensions[this.name];if(void 0!==o.clearcoatFactor&&(n.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&r.push(s.assignTexture(n,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(n.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&r.push(s.assignTexture(n,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(r.push(s.assignTexture(n,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const c=o.clearcoatNormalTexture.scale;n.clearcoatNormalScale=new u.FM8(c,c)}return Promise.all(r)}}class Sn{constructor(e){this.parser=e,this.name=O.KHR_MATERIALS_SHEEN}getMaterialType(e){const s=this.parser.json.materials[e];return s.extensions&&s.extensions[this.name]?u.EJi:null}extendMaterialParams(e,n){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[];n.sheenColor=new u.Ilk(0,0,0),n.sheenRoughness=0,n.sheen=1;const o=i.extensions[this.name];return void 0!==o.sheenColorFactor&&n.sheenColor.fromArray(o.sheenColorFactor),void 0!==o.sheenRoughnessFactor&&(n.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&r.push(s.assignTexture(n,"sheenColorMap",o.sheenColorTexture)),void 0!==o.sheenRoughnessTexture&&r.push(s.assignTexture(n,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(r)}}class En{constructor(e){this.parser=e,this.name=O.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const s=this.parser.json.materials[e];return s.extensions&&s.extensions[this.name]?u.EJi:null}extendMaterialParams(e,n){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],o=i.extensions[this.name];return void 0!==o.transmissionFactor&&(n.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&r.push(s.assignTexture(n,"transmissionMap",o.transmissionTexture)),Promise.all(r)}}class Rn{constructor(e){this.parser=e,this.name=O.KHR_MATERIALS_VOLUME}getMaterialType(e){const s=this.parser.json.materials[e];return s.extensions&&s.extensions[this.name]?u.EJi:null}extendMaterialParams(e,n){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],o=i.extensions[this.name];n.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&r.push(s.assignTexture(n,"thicknessMap",o.thicknessTexture)),n.attenuationDistance=o.attenuationDistance||0;const c=o.attenuationColor||[1,1,1];return n.attenuationColor=new u.Ilk(c[0],c[1],c[2]),Promise.all(r)}}class In{constructor(e){this.parser=e,this.name=O.KHR_MATERIALS_IOR}getMaterialType(e){const s=this.parser.json.materials[e];return s.extensions&&s.extensions[this.name]?u.EJi:null}extendMaterialParams(e,n){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=i.extensions[this.name];return n.ior=void 0!==r.ior?r.ior:1.5,Promise.resolve()}}class Cn{constructor(e){this.parser=e,this.name=O.KHR_MATERIALS_SPECULAR}getMaterialType(e){const s=this.parser.json.materials[e];return s.extensions&&s.extensions[this.name]?u.EJi:null}extendMaterialParams(e,n){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],o=i.extensions[this.name];n.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&r.push(s.assignTexture(n,"specularIntensityMap",o.specularTexture));const c=o.specularColorFactor||[1,1,1];return n.specularColor=new u.Ilk(c[0],c[1],c[2]),void 0!==o.specularColorTexture&&r.push(s.assignTexture(n,"specularColorMap",o.specularColorTexture).then(function(a){a.encoding=u.knz})),Promise.all(r)}}class Ln{constructor(e){this.parser=e,this.name=O.KHR_TEXTURE_BASISU}loadTexture(e){const n=this.parser,s=n.json,i=s.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const o=s.images[i.extensions[this.name].source],c=n.options.ktx2Loader;if(!c){if(s.extensionsRequired&&s.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return n.loadTextureImage(e,o,c)}}class kn{constructor(e){this.parser=e,this.name=O.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const n=this.name,s=this.parser,i=s.json,r=i.textures[e];if(!r.extensions||!r.extensions[n])return null;const c=i.images[r.extensions[n].source];let a=s.textureLoader;if(c.uri){const l=s.options.manager.getHandler(c.uri);null!==l&&(a=l)}return this.detectSupport().then(function(l){if(l)return s.loadTextureImage(e,c,a);if(i.extensionsRequired&&i.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return s.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",n.onload=n.onerror=function(){e(1===n.height)}})),this.isSupported}}class On{constructor(e){this.name=O.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const n=this.parser.json,s=n.bufferViews[e];if(s.extensions&&s.extensions[this.name]){const i=s.extensions[this.name],r=this.parser.getDependency("buffer",i.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([r,o.ready]).then(function(c){const a=i.byteOffset||0,l=i.byteLength||0,f=i.count,h=i.byteStride,d=new ArrayBuffer(f*h),p=new Uint8Array(c[0],a,l);return o.decodeGltfBuffer(new Uint8Array(d),f,h,p,i.mode,i.filter),d})}return null}}const Et="glTF";class Un{constructor(e){this.name=O.KHR_BINARY_GLTF,this.content=null,this.body=null;const n=new DataView(e,0,12);if(this.header={magic:u.Zp0.decodeText(new Uint8Array(e.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==Et)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const s=this.header.length-12,i=new DataView(e,12);let r=0;for(;r<s;){const o=i.getUint32(r,!0);r+=4;const c=i.getUint32(r,!0);if(r+=4,1313821514===c){const a=new Uint8Array(e,12+r,o);this.content=u.Zp0.decodeText(a)}else if(5130562===c){const a=12+r;this.body=e.slice(a,a+o)}r+=o}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Pn{constructor(e,n){if(!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=O.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=n,this.dracoLoader.preload()}decodePrimitive(e,n){const s=this.json,i=this.dracoLoader,r=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,c={},a={},l={};for(const f in o){const h=ot[f]||f.toLowerCase();c[h]=o[f]}for(const f in e.attributes){const h=ot[f]||f.toLowerCase();if(void 0!==o[f]){const d=s.accessors[e.attributes[f]];l[h]=Ce[d.componentType],a[h]=!0===d.normalized}}return n.getDependency("bufferView",r).then(function(f){return new Promise(function(h){i.decodeDracoFile(f,function(d){for(const p in d.attributes){const y=d.attributes[p],v=a[p];void 0!==v&&(y.normalized=v)}h(d)},c,l)})})}}class Dn{constructor(){this.name=O.KHR_TEXTURE_TRANSFORM}extendTexture(e,n){return void 0!==n.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===n.offset&&void 0===n.rotation&&void 0===n.scale||(e=e.clone(),void 0!==n.offset&&e.offset.fromArray(n.offset),void 0!==n.rotation&&(e.rotation=n.rotation),void 0!==n.scale&&e.repeat.fromArray(n.scale),e.needsUpdate=!0),e}}class rt extends u.Wid{constructor(e){super(),this.isGLTFSpecularGlossinessMaterial=!0;const n=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),s=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),i=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),r=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),c={specular:{value:(new u.Ilk).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=c,this.onBeforeCompile=function(a){for(const l in c)a.uniforms[l]=c[l];a.fragmentShader=a.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",n).replace("#include <metalnessmap_pars_fragment>",s).replace("#include <roughnessmap_fragment>",i).replace("#include <metalnessmap_fragment>",r).replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return c.specular.value},set:function(a){c.specular.value=a}},specularMap:{get:function(){return c.specularMap.value},set:function(a){c.specularMap.value=a,a?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return c.glossiness.value},set:function(a){c.glossiness.value=a}},glossinessMap:{get:function(){return c.glossinessMap.value},set:function(a){c.glossinessMap.value=a,a?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class Fn{constructor(){this.name=O.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}getMaterialType(){return rt}extendParams(e,n,s){const i=n.extensions[this.name];e.color=new u.Ilk(1,1,1),e.opacity=1;const r=[];if(Array.isArray(i.diffuseFactor)){const o=i.diffuseFactor;e.color.fromArray(o),e.opacity=o[3]}if(void 0!==i.diffuseTexture&&r.push(s.assignTexture(e,"map",i.diffuseTexture)),e.emissive=new u.Ilk(0,0,0),e.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1,e.specular=new u.Ilk(1,1,1),Array.isArray(i.specularFactor)&&e.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture){const o=i.specularGlossinessTexture;r.push(s.assignTexture(e,"glossinessMap",o)),r.push(s.assignTexture(e,"specularMap",o))}return Promise.all(r)}createMaterial(e){const n=new rt(e);return n.fog=!0,n.color=e.color,n.map=void 0===e.map?null:e.map,n.lightMap=null,n.lightMapIntensity=1,n.aoMap=void 0===e.aoMap?null:e.aoMap,n.aoMapIntensity=1,n.emissive=e.emissive,n.emissiveIntensity=1,n.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,n.bumpMap=void 0===e.bumpMap?null:e.bumpMap,n.bumpScale=1,n.normalMap=void 0===e.normalMap?null:e.normalMap,n.normalMapType=u.IOt,e.normalScale&&(n.normalScale=e.normalScale),n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.specularMap=void 0===e.specularMap?null:e.specularMap,n.specular=e.specular,n.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,n.glossiness=e.glossiness,n.alphaMap=null,n.envMap=void 0===e.envMap?null:e.envMap,n.envMapIntensity=1,n.refractionRatio=.98,n}}class zn{constructor(){this.name=O.KHR_MESH_QUANTIZATION}}class ve extends u._C8{constructor(e,n,s,i){super(e,n,s,i)}copySampleValue_(e){const n=this.resultBuffer,s=this.sampleValues,i=this.valueSize,r=e*i*3+i;for(let o=0;o!==i;o++)n[o]=s[r+o];return n}}ve.prototype.beforeStart_=ve.prototype.copySampleValue_,ve.prototype.afterEnd_=ve.prototype.copySampleValue_,ve.prototype.interpolate_=function(t,e,n,s){const i=this.resultBuffer,r=this.sampleValues,o=this.valueSize,c=2*o,a=3*o,l=s-e,f=(n-e)/l,h=f*f,d=h*f,p=t*a,y=p-a,v=-2*d+3*h,m=d-h,w=1-v,T=m-h+f;for(let _=0;_!==o;_++)i[_]=w*r[y+_+o]+T*(r[y+_+c]*l)+v*r[p+_+o]+m*(r[p+_]*l);return i};const Nn=new u._fP;class Gn extends ve{interpolate_(e,n,s,i){const r=super.interpolate_(e,n,s,i);return Nn.fromArray(r).normalize().toArray(r),r}}const Ce={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},It={9728:u.TyD,9729:u.wem,9984:u.YLQ,9985:u.qyh,9986:u.aH4,9987:u.D1R},Ct={33071:u.uWy,33648:u.OoA,10497:u.rpg},Lt={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ot={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},fe={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Hn={CUBICSPLINE:void 0,LINEAR:u.NMF,STEP:u.Syv};function Le(t,e,n){for(const s in n.extensions)void 0===t[s]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[s]=n.extensions[s])}function we(t,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Bn(t,e){if(t.updateMorphTargets(),void 0!==e.weights)for(let n=0,s=e.weights.length;n<s;n++)t.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){const n=e.extras.targetNames;if(t.morphTargetInfluences.length===n.length){t.morphTargetDictionary={};for(let s=0,i=n.length;s<i;s++)t.morphTargetDictionary[n[s]]=s}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Kn(t){const e=t.extensions&&t.extensions[O.KHR_DRACO_MESH_COMPRESSION];let n;return n=e?"draco:"+e.bufferView+":"+e.indices+":"+kt(e.attributes):t.indices+":"+kt(t.attributes)+":"+t.mode,n}function kt(t){let e="";const n=Object.keys(t).sort();for(let s=0,i=n.length;s<i;s++)e+=n[s]+":"+t[n[s]]+";";return e}function ct(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class $n{constructor(e={},n={}){this.json=e,this.extensions={},this.plugins={},this.options=n,this.cache=new Mn,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.textureCache={},this.nodeNamesUsed={},this.textureLoader="undefined"!=typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?new u.QRU(this.options.manager):new u.dpR(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new u.hH6(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,n){const s=this,i=this.json,r=this.extensions;this.cache.removeAll(),this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([s.getDependencies("scene"),s.getDependencies("animation"),s.getDependencies("camera")])}).then(function(o){const c={scene:o[0][i.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:i.asset,parser:s,userData:{}};Le(r,c,i),we(c,i),Promise.all(s._invokeAll(function(a){return a.afterRoot&&a.afterRoot(c)})).then(function(){e(c)})}).catch(n)}_markDefs(){const e=this.json.nodes||[],n=this.json.skins||[],s=this.json.meshes||[];for(let i=0,r=n.length;i<r;i++){const o=n[i].joints;for(let c=0,a=o.length;c<a;c++)e[o[c]].isBone=!0}for(let i=0,r=e.length;i<r;i++){const o=e[i];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(s[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,n){void 0!==n&&(void 0===e.refs[n]&&(e.refs[n]=e.uses[n]=0),e.refs[n]++)}_getNodeRef(e,n,s){if(e.refs[n]<=1)return s;const i=s.clone(),r=(o,c)=>{const a=this.associations.get(o);null!=a&&this.associations.set(c,a);for(const[l,f]of o.children.entries())r(f,c.children[l])};return r(s,i),i.name+="_instance_"+e.uses[n]++,i}_invokeOne(e){const n=Object.values(this.plugins);n.push(this);for(let s=0;s<n.length;s++){const i=e(n[s]);if(i)return i}return null}_invokeAll(e){const n=Object.values(this.plugins);n.unshift(this);const s=[];for(let i=0;i<n.length;i++){const r=e(n[i]);r&&s.push(r)}return s}getDependency(e,n){const s=e+":"+n;let i=this.cache.get(s);if(!i){switch(e){case"scene":i=this.loadScene(n);break;case"node":i=this.loadNode(n);break;case"mesh":i=this._invokeOne(function(r){return r.loadMesh&&r.loadMesh(n)});break;case"accessor":i=this.loadAccessor(n);break;case"bufferView":i=this._invokeOne(function(r){return r.loadBufferView&&r.loadBufferView(n)});break;case"buffer":i=this.loadBuffer(n);break;case"material":i=this._invokeOne(function(r){return r.loadMaterial&&r.loadMaterial(n)});break;case"texture":i=this._invokeOne(function(r){return r.loadTexture&&r.loadTexture(n)});break;case"skin":i=this.loadSkin(n);break;case"animation":i=this.loadAnimation(n);break;case"camera":i=this.loadCamera(n);break;default:throw new Error("Unknown type: "+e)}this.cache.add(s,i)}return i}getDependencies(e){let n=this.cache.get(e);if(!n){const s=this;n=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(r,o){return s.getDependency(e,o)})),this.cache.add(e,n)}return n}loadBuffer(e){const n=this.json.buffers[e],s=this.fileLoader;if(n.type&&"arraybuffer"!==n.type)throw new Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");if(void 0===n.uri&&0===e)return Promise.resolve(this.extensions[O.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(r,o){s.load(u.Zp0.resolveURL(n.uri,i.path),r,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})})}loadBufferView(e){const n=this.json.bufferViews[e];return this.getDependency("buffer",n.buffer).then(function(s){const r=n.byteOffset||0;return s.slice(r,r+(n.byteLength||0))})}loadAccessor(e){const n=this,s=this.json,i=this.json.accessors[e];if(void 0===i.bufferView&&void 0===i.sparse)return Promise.resolve(null);const r=[];return r.push(void 0!==i.bufferView?this.getDependency("bufferView",i.bufferView):null),void 0!==i.sparse&&(r.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(r).then(function(o){const c=o[0],a=Lt[i.type],l=Ce[i.componentType],f=l.BYTES_PER_ELEMENT,d=i.byteOffset||0,p=void 0!==i.bufferView?s.bufferViews[i.bufferView].byteStride:void 0,y=!0===i.normalized;let v,m;if(p&&p!==f*a){const w=Math.floor(d/p),T="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+w+":"+i.count;let _=n.cache.get(T);_||(v=new l(c,w*p,i.count*p/f),_=new u.vpT(v,p/f),n.cache.add(T,_)),m=new u.kB5(_,a,d%p/f,y)}else v=null===c?new l(i.count*a):new l(c,d,i.count*a),m=new u.TlE(v,a,y);if(void 0!==i.sparse){const S=i.sparse.values.byteOffset||0,A=new(0,Ce[i.sparse.indices.componentType])(o[1],i.sparse.indices.byteOffset||0,i.sparse.count*Lt.SCALAR),b=new l(o[2],S,i.sparse.count*a);null!==c&&(m=new u.TlE(m.array.slice(),m.itemSize,m.normalized));for(let M=0,x=A.length;M<x;M++){const P=A[M];if(m.setX(P,b[M*a]),a>=2&&m.setY(P,b[M*a+1]),a>=3&&m.setZ(P,b[M*a+2]),a>=4&&m.setW(P,b[M*a+3]),a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return m})}loadTexture(e){const n=this.json,r=n.images[n.textures[e].source];let o=this.textureLoader;if(r.uri){const c=this.options.manager.getHandler(r.uri);null!==c&&(o=c)}return this.loadTextureImage(e,r,o)}loadTextureImage(e,n,s){const i=this,r=this.json,o=this.options,c=r.textures[e],a=(n.uri||n.bufferView)+":"+c.sampler;if(this.textureCache[a])return this.textureCache[a];const l=self.URL||self.webkitURL;let f=n.uri||"",h=!1;if(void 0!==n.bufferView)f=i.getDependency("bufferView",n.bufferView).then(function(p){h=!0;const y=new Blob([p],{type:n.mimeType});return f=l.createObjectURL(y),f});else if(void 0===n.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const d=Promise.resolve(f).then(function(p){return new Promise(function(y,v){let m=y;!0===s.isImageBitmapLoader&&(m=function(w){const T=new u.xEZ(w);T.needsUpdate=!0,y(T)}),s.load(u.Zp0.resolveURL(p,o.path),m,void 0,v)})}).then(function(p){!0===h&&l.revokeObjectURL(f),p.flipY=!1,c.name&&(p.name=c.name);const v=(r.samplers||{})[c.sampler]||{};return p.magFilter=It[v.magFilter]||u.wem,p.minFilter=It[v.minFilter]||u.D1R,p.wrapS=Ct[v.wrapS]||u.rpg,p.wrapT=Ct[v.wrapT]||u.rpg,i.associations.set(p,{textures:e}),p}).catch(function(){return console.error("THREE.GLTFLoader: Couldn't load texture",f),null});return this.textureCache[a]=d,d}assignTexture(e,n,s){const i=this;return this.getDependency("texture",s.index).then(function(r){if(void 0!==s.texCoord&&0!=s.texCoord&&!("aoMap"===n&&1==s.texCoord)&&console.warn("THREE.GLTFLoader: Custom UV set "+s.texCoord+" for texture "+n+" not yet supported."),i.extensions[O.KHR_TEXTURE_TRANSFORM]){const o=void 0!==s.extensions?s.extensions[O.KHR_TEXTURE_TRANSFORM]:void 0;if(o){const c=i.associations.get(r);r=i.extensions[O.KHR_TEXTURE_TRANSFORM].extendTexture(r,o),i.associations.set(r,c)}}return e[n]=r,r})}assignFinalMaterial(e){const n=e.geometry;let s=e.material;const i=void 0===n.attributes.tangent,r=void 0!==n.attributes.color,o=void 0===n.attributes.normal;if(e.isPoints){const c="PointsMaterial:"+s.uuid;let a=this.cache.get(c);a||(a=new u.UY4,u.F5T.prototype.copy.call(a,s),a.color.copy(s.color),a.map=s.map,a.sizeAttenuation=!1,this.cache.add(c,a)),s=a}else if(e.isLine){const c="LineBasicMaterial:"+s.uuid;let a=this.cache.get(c);a||(a=new u.nls,u.F5T.prototype.copy.call(a,s),a.color.copy(s.color),this.cache.add(c,a)),s=a}if(i||r||o){let c="ClonedMaterial:"+s.uuid+":";s.isGLTFSpecularGlossinessMaterial&&(c+="specular-glossiness:"),i&&(c+="derivative-tangents:"),r&&(c+="vertex-colors:"),o&&(c+="flat-shading:");let a=this.cache.get(c);a||(a=s.clone(),r&&(a.vertexColors=!0),o&&(a.flatShading=!0),i&&(a.normalScale&&(a.normalScale.y*=-1),a.clearcoatNormalScale&&(a.clearcoatNormalScale.y*=-1)),this.cache.add(c,a),this.associations.set(a,this.associations.get(s))),s=a}s.aoMap&&void 0===n.attributes.uv2&&void 0!==n.attributes.uv&&n.setAttribute("uv2",n.attributes.uv),e.material=s}getMaterialType(){return u.Wid}loadMaterial(e){const n=this,i=this.extensions,r=this.json.materials[e];let o;const c={},a=r.extensions||{},l=[];if(a[O.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const h=i[O.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];o=h.getMaterialType(),l.push(h.extendParams(c,r,n))}else if(a[O.KHR_MATERIALS_UNLIT]){const h=i[O.KHR_MATERIALS_UNLIT];o=h.getMaterialType(),l.push(h.extendParams(c,r,n))}else{const h=r.pbrMetallicRoughness||{};if(c.color=new u.Ilk(1,1,1),c.opacity=1,Array.isArray(h.baseColorFactor)){const d=h.baseColorFactor;c.color.fromArray(d),c.opacity=d[3]}void 0!==h.baseColorTexture&&l.push(n.assignTexture(c,"map",h.baseColorTexture)),c.metalness=void 0!==h.metallicFactor?h.metallicFactor:1,c.roughness=void 0!==h.roughnessFactor?h.roughnessFactor:1,void 0!==h.metallicRoughnessTexture&&(l.push(n.assignTexture(c,"metalnessMap",h.metallicRoughnessTexture)),l.push(n.assignTexture(c,"roughnessMap",h.metallicRoughnessTexture))),o=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),l.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,c)})))}!0===r.doubleSided&&(c.side=u.ehD);const f=r.alphaMode||"OPAQUE";if("BLEND"===f?(c.transparent=!0,c.depthWrite=!1):(c.format=u.UCm,c.transparent=!1,"MASK"===f&&(c.alphaTest=void 0!==r.alphaCutoff?r.alphaCutoff:.5)),void 0!==r.normalTexture&&o!==u.vBJ&&(l.push(n.assignTexture(c,"normalMap",r.normalTexture)),c.normalScale=new u.FM8(1,1),void 0!==r.normalTexture.scale)){const h=r.normalTexture.scale;c.normalScale.set(h,h)}return void 0!==r.occlusionTexture&&o!==u.vBJ&&(l.push(n.assignTexture(c,"aoMap",r.occlusionTexture)),void 0!==r.occlusionTexture.strength&&(c.aoMapIntensity=r.occlusionTexture.strength)),void 0!==r.emissiveFactor&&o!==u.vBJ&&(c.emissive=(new u.Ilk).fromArray(r.emissiveFactor)),void 0!==r.emissiveTexture&&o!==u.vBJ&&l.push(n.assignTexture(c,"emissiveMap",r.emissiveTexture)),Promise.all(l).then(function(){let h;return h=o===rt?i[O.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(c):new o(c),r.name&&(h.name=r.name),h.map&&(h.map.encoding=u.knz),h.emissiveMap&&(h.emissiveMap.encoding=u.knz),we(h,r),n.associations.set(h,{materials:e}),r.extensions&&Le(i,h,r),h})}createUniqueName(e){const n=u.iUV.sanitizeNodeName(e||"");let s=n;for(let i=1;this.nodeNamesUsed[s];++i)s=n+"_"+i;return this.nodeNamesUsed[s]=!0,s}loadGeometries(e){const n=this,s=this.extensions,i=this.primitiveCache;function r(c){return s[O.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(c,n).then(function(a){return Ut(a,c,n)})}const o=[];for(let c=0,a=e.length;c<a;c++){const l=e[c],f=Kn(l),h=i[f];if(h)o.push(h.promise);else{let d;d=l.extensions&&l.extensions[O.KHR_DRACO_MESH_COMPRESSION]?r(l):Ut(new u.u9r,l,n),i[f]={primitive:l,promise:d},o.push(d)}}return Promise.all(o)}loadMesh(e){const n=this,i=this.extensions,r=this.json.meshes[e],o=r.primitives,c=[];for(let a=0,l=o.length;a<l;a++){const f=void 0===o[a].material?(void 0===(t=this.cache).DefaultMaterial&&(t.DefaultMaterial=new u.Wid({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:u.Wl3})),t.DefaultMaterial):this.getDependency("material",o[a].material);c.push(f)}var t;return c.push(n.loadGeometries(o)),Promise.all(c).then(function(a){const l=a.slice(0,a.length-1),f=a[a.length-1],h=[];for(let p=0,y=f.length;p<y;p++){const v=f[p],m=o[p];let w;const T=l[p];if(4===m.mode||5===m.mode||6===m.mode||void 0===m.mode)w=!0===r.isSkinnedMesh?new u.TUv(v,T):new u.Kj0(v,T),!0===w.isSkinnedMesh&&!w.geometry.attributes.skinWeight.normalized&&w.normalizeSkinWeights(),5===m.mode?w.geometry=Pt(w.geometry,u.UlW):6===m.mode&&(w.geometry=Pt(w.geometry,u.z$h));else if(1===m.mode)w=new u.ejS(v,T);else if(3===m.mode)w=new u.x12(v,T);else if(2===m.mode)w=new u.blk(v,T);else{if(0!==m.mode)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+m.mode);w=new u.woe(v,T)}Object.keys(w.geometry.morphAttributes).length>0&&Bn(w,r),w.name=n.createUniqueName(r.name||"mesh_"+e),we(w,r),m.extensions&&Le(i,w,m),n.assignFinalMaterial(w),h.push(w)}for(let p=0,y=h.length;p<y;p++)n.associations.set(h[p],{meshes:e,primitives:p});if(1===h.length)return h[0];const d=new u.ZAu;n.associations.set(d,{meshes:e});for(let p=0,y=h.length;p<y;p++)d.add(h[p]);return d})}loadCamera(e){let n;const s=this.json.cameras[e],i=s[s.type];if(i)return"perspective"===s.type?n=new u.cPb(u.M8C.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===s.type&&(n=new u.iKG(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),s.name&&(n.name=this.createUniqueName(s.name)),we(n,s),Promise.resolve(n);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const n=this.json.skins[e],s={joints:n.joints};return void 0===n.inverseBindMatrices?Promise.resolve(s):this.getDependency("accessor",n.inverseBindMatrices).then(function(i){return s.inverseBindMatrices=i,s})}loadAnimation(e){const s=this.json.animations[e],i=[],r=[],o=[],c=[],a=[];for(let l=0,f=s.channels.length;l<f;l++){const h=s.channels[l],d=s.samplers[h.sampler],p=h.target,v=void 0!==s.parameters?s.parameters[d.input]:d.input,m=void 0!==s.parameters?s.parameters[d.output]:d.output;i.push(this.getDependency("node",void 0!==p.node?p.node:p.id)),r.push(this.getDependency("accessor",v)),o.push(this.getDependency("accessor",m)),c.push(d),a.push(p)}return Promise.all([Promise.all(i),Promise.all(r),Promise.all(o),Promise.all(c),Promise.all(a)]).then(function(l){const f=l[0],h=l[1],d=l[2],p=l[3],y=l[4],v=[];for(let w=0,T=f.length;w<T;w++){const _=f[w],S=h[w],A=d[w],b=p[w],M=y[w];if(void 0===_)continue;let x;switch(_.updateMatrix(),_.matrixAutoUpdate=!0,fe[M.path]){case fe.weights:x=u.dUE;break;case fe.rotation:x=u.iLg;break;case fe.position:case fe.scale:default:x=u.yC1}const P=_.name?_.name:_.uuid,N=void 0!==b.interpolation?Hn[b.interpolation]:u.NMF,D=[];fe[M.path]===fe.weights?_.traverse(function(I){I.morphTargetInfluences&&D.push(I.name?I.name:I.uuid)}):D.push(P);let E=A.array;if(A.normalized){const I=ct(E.constructor),U=new Float32Array(E.length);for(let L=0,R=E.length;L<R;L++)U[L]=E[L]*I;E=U}for(let I=0,U=D.length;I<U;I++){const L=new x(D[I]+"."+fe[M.path],S.array,E,N);"CUBICSPLINE"===b.interpolation&&(L.createInterpolant=function(j){return new(this instanceof u.iLg?Gn:ve)(this.times,this.values,this.getValueSize()/3,j)},L.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),v.push(L)}}return new u.m7l(s.name?s.name:"animation_"+e,void 0,v)})}createNodeMesh(e){const s=this,i=this.json.nodes[e];return void 0===i.mesh?null:s.getDependency("mesh",i.mesh).then(function(r){const o=s._getNodeRef(s.meshCache,i.mesh,r);return void 0!==i.weights&&o.traverse(function(c){if(c.isMesh)for(let a=0,l=i.weights.length;a<l;a++)c.morphTargetInfluences[a]=i.weights[a]}),o})}loadNode(e){const s=this.extensions,i=this,r=this.json.nodes[e],o=r.name?i.createUniqueName(r.name):"";return function(){const c=[],a=i._invokeOne(function(l){return l.createNodeMesh&&l.createNodeMesh(e)});return a&&c.push(a),void 0!==r.camera&&c.push(i.getDependency("camera",r.camera).then(function(l){return i._getNodeRef(i.cameraCache,r.camera,l)})),i._invokeAll(function(l){return l.createNodeAttachment&&l.createNodeAttachment(e)}).forEach(function(l){c.push(l)}),Promise.all(c)}().then(function(c){let a;if(a=!0===r.isBone?new u.N$j:c.length>1?new u.ZAu:1===c.length?c[0]:new u.Tme,a!==c[0])for(let l=0,f=c.length;l<f;l++)a.add(c[l]);if(r.name&&(a.userData.name=r.name,a.name=o),we(a,r),r.extensions&&Le(s,a,r),void 0!==r.matrix){const l=new u.yGw;l.fromArray(r.matrix),a.applyMatrix4(l)}else void 0!==r.translation&&a.position.fromArray(r.translation),void 0!==r.rotation&&a.quaternion.fromArray(r.rotation),void 0!==r.scale&&a.scale.fromArray(r.scale);return i.associations.has(a)||i.associations.set(a,{}),i.associations.get(a).nodes=e,a})}loadScene(e){const n=this.json,s=this.extensions,i=this.json.scenes[e],r=this,o=new u.ZAu;i.name&&(o.name=r.createUniqueName(i.name)),we(o,i),i.extensions&&Le(s,o,i);const c=i.nodes||[],a=[];for(let l=0,f=c.length;l<f;l++)a.push(Ot(c[l],o,n,r));return Promise.all(a).then(function(){return r.associations=(f=>{const h=new Map;for(const[d,p]of r.associations)(d instanceof u.F5T||d instanceof u.xEZ)&&h.set(d,p);return f.traverse(d=>{const p=r.associations.get(d);null!=p&&h.set(d,p)}),h})(o),o})}}function Ot(t,e,n,s){const i=n.nodes[t];return s.getDependency("node",t).then(function(r){if(void 0===i.skin)return r;let o;return s.getDependency("skin",i.skin).then(function(c){o=c;const a=[];for(let l=0,f=o.joints.length;l<f;l++)a.push(s.getDependency("node",o.joints[l]));return Promise.all(a)}).then(function(c){return r.traverse(function(a){if(!a.isMesh)return;const l=[],f=[];for(let h=0,d=c.length;h<d;h++){const p=c[h];if(p){l.push(p);const y=new u.yGw;void 0!==o.inverseBindMatrices&&y.fromArray(o.inverseBindMatrices.array,16*h),f.push(y)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',o.joints[h])}a.bind(new u.OdW(l,f),a.matrixWorld)}),r})}).then(function(r){e.add(r);const o=[];if(i.children){const c=i.children;for(let a=0,l=c.length;a<l;a++)o.push(Ot(c[a],r,n,s))}return Promise.all(o)})}function Ut(t,e,n){const s=e.attributes,i=[];function r(o,c){return n.getDependency("accessor",o).then(function(a){t.setAttribute(c,a)})}for(const o in s){const c=ot[o]||o.toLowerCase();c in t.attributes||i.push(r(s[o],c))}if(void 0!==e.indices&&!t.index){const o=n.getDependency("accessor",e.indices).then(function(c){t.setIndex(c)});i.push(o)}return we(t,e),function(t,e,n){const s=e.attributes,i=new u.ZzF;if(void 0===s.POSITION)return;{const c=n.json.accessors[s.POSITION],a=c.min,l=c.max;if(void 0===a||void 0===l)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(i.set(new u.Pa4(a[0],a[1],a[2]),new u.Pa4(l[0],l[1],l[2])),c.normalized){const f=ct(Ce[c.componentType]);i.min.multiplyScalar(f),i.max.multiplyScalar(f)}}const r=e.targets;if(void 0!==r){const c=new u.Pa4,a=new u.Pa4;for(let l=0,f=r.length;l<f;l++){const h=r[l];if(void 0!==h.POSITION){const d=n.json.accessors[h.POSITION],p=d.min,y=d.max;if(void 0!==p&&void 0!==y){if(a.setX(Math.max(Math.abs(p[0]),Math.abs(y[0]))),a.setY(Math.max(Math.abs(p[1]),Math.abs(y[1]))),a.setZ(Math.max(Math.abs(p[2]),Math.abs(y[2]))),d.normalized){const v=ct(Ce[d.componentType]);a.multiplyScalar(v)}c.max(a)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(c)}t.boundingBox=i;const o=new u.aLr;i.getCenter(o.center),o.radius=i.min.distanceTo(i.max)/2,t.boundingSphere=o}(t,e,n),Promise.all(i).then(function(){return void 0!==e.targets?function(t,e,n){let s=!1,i=!1;for(let c=0,a=e.length;c<a;c++){const l=e[c];if(void 0!==l.POSITION&&(s=!0),void 0!==l.NORMAL&&(i=!0),s&&i)break}if(!s&&!i)return Promise.resolve(t);const r=[],o=[];for(let c=0,a=e.length;c<a;c++){const l=e[c];if(s){const f=void 0!==l.POSITION?n.getDependency("accessor",l.POSITION):t.attributes.position;r.push(f)}if(i){const f=void 0!==l.NORMAL?n.getDependency("accessor",l.NORMAL):t.attributes.normal;o.push(f)}}return Promise.all([Promise.all(r),Promise.all(o)]).then(function(c){const l=c[1];return s&&(t.morphAttributes.position=c[0]),i&&(t.morphAttributes.normal=l),t.morphTargetsRelative=!0,t})}(t,e.targets,n):t})}function Pt(t,e){let n=t.getIndex();if(null===n){const o=[],c=t.getAttribute("position");if(void 0===c)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(let a=0;a<c.count;a++)o.push(a);t.setIndex(o),n=t.getIndex()}const s=n.count-2,i=[];if(e===u.z$h)for(let o=1;o<=s;o++)i.push(n.getX(0)),i.push(n.getX(o)),i.push(n.getX(o+1));else for(let o=0;o<s;o++)o%2==0?(i.push(n.getX(o)),i.push(n.getX(o+1)),i.push(n.getX(o+2))):(i.push(n.getX(o+2)),i.push(n.getX(o+1)),i.push(n.getX(o)));i.length/3!==s&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const r=t.clone();return r.setIndex(i),r}const qn=["container"];let Wn=(()=>{class t{constructor(){}ngOnInit(){}ngAfterViewInit(){this.initScene()}initScene(){var n;const s=new u.xsS,i=new u.cPb(50,window.innerWidth/window.innerHeight,.1,1e3);i.position.set(0,10,30);const r=new u.CP7;r.setSize(window.innerWidth,window.innerHeight),r.setClearColor(8042478,1),null===(n=this.container)||void 0===n||n.nativeElement.appendChild(r.domElement),s.fog=new u.ybr(8042478,0,200);const c=new u.xo$(10,60,60),a=new u.xoR({color:5800016}),l=new u.Kj0(c,a);s.add(l);const f=new u.ZAu;s.add(f);const h=new u.vBJ({color:9000270}),d=new u.xoR({color:5800016});for(let T=0;T<66;T++){const _=new u.ZAu;f.add(_);const S=new u.DvJ(.2,1,.2),A=new u.Kj0(S,h);A.position.set(0,10.5,0),_.add(A);const b=new u.b_z(.6,1,6),M=new u.Kj0(b,d);M.position.set(0,11.2,0);let x=1+.6*Math.random()-.3;M.scale.set(x,x,x),_.add(M),_.rotation.set(2*Math.PI*Math.random(),2*Math.PI*Math.random(),2*Math.PI*Math.random())}r.render(s,i),new Re.z(i,r.domElement).minDistance=14;const y=new u.Ox3(16777215,1);y.position.set(1,1,1),s.add(y);const v=new u.Mig(4473924);s.add(v);const m=()=>{this.request=requestAnimationFrame(m),i.aspect=window.innerWidth/window.innerHeight,i.updateProjectionMatrix(),r.setSize(window.innerWidth,window.innerHeight),r.render(s,i),f.rotation.y+=.001};m(),(new St).load("assets/models/tree.gltf",T=>{let _=[];T.scene.children.forEach(S=>{_.push(S)});for(let S=0;S<60;S++)_.forEach(A=>{const b=new u.ZAu;f.add(b),b.add(A.clone()),A.position.set(0,10,0);let M=.15+.1*Math.random();A.scale.set(M,M,M),b.rotation.set(2*Math.PI*Math.random(),2*Math.PI*Math.random(),2*Math.PI*Math.random())})})}ngOnDestroy(){cancelAnimationFrame(this.request)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-m1"]],viewQuery:function(n,s){if(1&n&&g.Gf(qn,5),2&n){let i;g.iGM(i=g.CRH())&&(s.container=i.first)}},decls:2,vars:0,consts:[["container",""]],template:function(n,s){1&n&&g._UZ(0,"div",null,0)},encapsulation:2}),t})();var t,he={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-he.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*he.Bounce.In(2*t):.5*he.Bounce.Out(2*t-1)+.5}}},ye="undefined"==typeof self&&"undefined"!=typeof process&&process.hrtime?function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()},Dt=function(){function t(){this._tweens={},this._tweensAddedDuringUpdate={}}return t.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(n){return e._tweens[n]})},t.prototype.removeAll=function(){this._tweens={}},t.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},t.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},t.prototype.update=function(e,n){void 0===e&&(e=ye()),void 0===n&&(n=!1);var s=Object.keys(this._tweens);if(0===s.length)return!1;for(;s.length>0;){this._tweensAddedDuringUpdate={};for(var i=0;i<s.length;i++){var r=this._tweens[s[i]];r&&!1===r.update(e,!n)&&!n&&delete this._tweens[s[i]]}s=Object.keys(this._tweensAddedDuringUpdate)}return!0},t}(),_e={Linear:function(t,e){var n=t.length-1,s=n*e,i=Math.floor(s),r=_e.Utils.Linear;return e<0?r(t[0],t[1],s):e>1?r(t[n],t[n-1],n-s):r(t[i],t[i+1>n?n:i+1],s-i)},Bezier:function(t,e){for(var n=0,s=t.length-1,i=Math.pow,r=_e.Utils.Bernstein,o=0;o<=s;o++)n+=i(1-e,s-o)*i(e,o)*t[o]*r(s,o);return n},CatmullRom:function(t,e){var n=t.length-1,s=n*e,i=Math.floor(s),r=_e.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(i=Math.floor(s=n*(1+e))),r(t[(i-1+n)%n],t[i],t[(i+1)%n],t[(i+2)%n],s-i)):e<0?t[0]-(r(t[0],t[0],t[1],t[1],-s)-t[0]):e>1?t[n]-(r(t[n],t[n],t[n-1],t[n-1],s-n)-t[n]):r(t[i?i-1:0],t[i],t[n<i+1?n:i+1],t[n<i+2?n:i+2],s-i)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=_e.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:(t=[1],function(e){var n=1;if(t[e])return t[e];for(var s=e;s>1;s--)n*=s;return t[e]=n,n}),CatmullRom:function(t,e,n,s,i){var r=.5*(n-t),o=.5*(s-e),c=i*i;return(2*e-2*n+r+o)*(i*c)+(-3*e+3*n-2*r-o)*c+r*i+e}}},lt=function(){function t(){}return t.nextId=function(){return t._nextId++},t._nextId=0,t}(),Ft=new Dt,je=function(){function t(e,n){void 0===n&&(n=Ft),this._object=e,this._group=n,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=he.Linear.None,this._interpolationFunction=_e.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=lt.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return t.prototype.getId=function(){return this._id},t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.isPaused=function(){return this._isPaused},t.prototype.to=function(e,n){return this._valuesEnd=Object.create(e),void 0!==n&&(this._duration=n),this},t.prototype.duration=function(e){return this._duration=e,this},t.prototype.start=function(e){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var n in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==e?"string"==typeof e?ye()+parseFloat(e):e:ye(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},t.prototype._setupProperties=function(e,n,s,i){for(var r in s){var o=e[r],c=Array.isArray(o),a=c?"array":typeof o,l=!c&&Array.isArray(s[r]);if("undefined"!==a&&"function"!==a){if(l){var f=s[r];if(0===f.length)continue;f=f.map(this._handleRelativeValue.bind(this,o)),s[r]=[o].concat(f)}if("object"!==a&&!c||!o||l)void 0===n[r]&&(n[r]=o),c||(n[r]*=1),i[r]=l?s[r].slice().reverse():n[r]||0;else{for(var h in n[r]=c?[]:{},o)n[r][h]=o[h];i[r]=c?[]:{},this._setupProperties(o,n[r],s[r],i[r])}}}},t.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},t.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},t.prototype.pause=function(e){return void 0===e&&(e=ye()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},t.prototype.resume=function(e){return void 0===e&&(e=ye()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},t.prototype.stopChainedTweens=function(){for(var e=0,n=this._chainedTweens.length;e<n;e++)this._chainedTweens[e].stop();return this},t.prototype.group=function(e){return this._group=e,this},t.prototype.delay=function(e){return this._delayTime=e,this},t.prototype.repeat=function(e){return this._initialRepeat=e,this._repeat=e,this},t.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},t.prototype.yoyo=function(e){return this._yoyo=e,this},t.prototype.easing=function(e){return this._easingFunction=e,this},t.prototype.interpolation=function(e){return this._interpolationFunction=e,this},t.prototype.chain=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._chainedTweens=e,this},t.prototype.onStart=function(e){return this._onStartCallback=e,this},t.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},t.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},t.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},t.prototype.onStop=function(e){return this._onStopCallback=e,this},t.prototype.update=function(e,n){if(void 0===e&&(e=ye()),void 0===n&&(n=!0),this._isPaused)return!0;var s,i;if(!this._goToEnd&&!this._isPlaying){if(e>this._startTime+this._duration)return!1;n&&this.start(e)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),i=(e-this._startTime)/this._duration;var o=this._easingFunction(i=0===this._duration||i>1?1:i);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,o),this._onUpdateCallback&&this._onUpdateCallback(this._object,i),1===i){if(this._repeat>0){for(s in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)!this._yoyo&&"string"==typeof this._valuesEnd[s]&&(this._valuesStartRepeat[s]=this._valuesStartRepeat[s]+parseFloat(this._valuesEnd[s])),this._yoyo&&this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s];return this._yoyo&&(this._reversed=!this._reversed),this._startTime=void 0!==this._repeatDelayTime?e+this._repeatDelayTime:e+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var c=0,a=this._chainedTweens.length;c<a;c++)this._chainedTweens[c].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},t.prototype._updateProperties=function(e,n,s,i){for(var r in s)if(void 0!==n[r]){var o=n[r]||0,c=s[r],a=Array.isArray(e[r]),l=Array.isArray(c);!a&&l?e[r]=this._interpolationFunction(c,i):"object"==typeof c&&c?this._updateProperties(e[r],o,c,i):"number"==typeof(c=this._handleRelativeValue(o,c))&&(e[r]=o+(c-o)*i)}},t.prototype._handleRelativeValue=function(e,n){return"string"!=typeof n?n:"+"===n.charAt(0)||"-"===n.charAt(0)?e+parseFloat(n):parseFloat(n)},t.prototype._swapEndStartRepeatValues=function(e){var n=this._valuesStartRepeat[e],s=this._valuesEnd[e];this._valuesStartRepeat[e]="string"==typeof s?this._valuesStartRepeat[e]+parseFloat(s):this._valuesEnd[e],this._valuesEnd[e]=n},t}(),se=Ft,Ze=(se.getAll.bind(se),se.removeAll.bind(se),se.add.bind(se),se.remove.bind(se),se.update.bind(se));const ns=["container"];let ss=(()=>{class t{constructor(){}ngOnInit(){}ngAfterViewInit(){this.initScene()}initScene(){var n;const s=new u.xsS,i=new u.cPb(50,window.innerWidth/window.innerHeight,.1,1e3);i.position.set(0,10,30);const r=new u.CP7({antialias:!0});r.setSize(window.innerWidth,window.innerHeight),r.setClearColor(8042478,1),r.shadowMap.enabled=!0,r.shadowMap.type=u.ntZ,null===(n=this.container)||void 0===n||n.nativeElement.appendChild(r.domElement),s.fog=new u.ybr(8042478,0,200),s.add(new u.y8_(10));const c=new u.xo$(10,60,60),a=new u.xoR({color:5800016}),l=new u.Kj0(c,a);l.receiveShadow=!0,s.add(l);const f=new u.ZAu;s.add(f);const h=new u.vBJ({color:9000270}),d=new u.xoR({color:5800016});let y=(A,b,M)=>{const x=new u.ZAu;x.scale.set(.1,.1,.1),f.add(x);const P=new u.DvJ(.2,.2,1),N=new u.Kj0(P,h);N.position.set(0,0,-.5),N.castShadow=!0,x.add(N);const D=new u.b_z(.6+.6*Math.random()-.3,1,6),E=new u.Kj0(D,d);E.position.set(0,0,-1.5),E.rotateX(-Math.PI/2),E.castShadow=!0,x.add(E),this.tweenScale(x,.1,1,2e3),x.position.set(A,b,M),x.lookAt(new u.Pa4(0,0,0))};r.render(s,i),new Re.z(i,r.domElement).minDistance=14;const m=new u.Ox3(16777215,1);m.position.set(10,10,10),m.castShadow=!0,m.shadow.camera.near=.1,m.shadow.camera.far=200,m.shadow.camera.left=-50,m.shadow.camera.right=50,m.shadow.camera.top=50,m.shadow.camera.bottom=-50,m.shadow.mapSize.width=1024,m.shadow.mapSize.height=1024,s.add(m);const w=new u.Mig(4473924);s.add(w);const T=()=>{this.request=requestAnimationFrame(T),i.aspect=window.innerWidth/window.innerHeight,i.updateProjectionMatrix(),r.setSize(window.innerWidth,window.innerHeight),r.render(s,i),f.rotation.y+=4e-4,Ze()};T();let _=0,S=setInterval(()=>{const A=this.spherical(10);y(A.x,A.y,A.z),_++,_>128&&clearInterval(S)},200)}tweenScale(n,s,i,r){const o={x:s};new je(o).to({x:i},r).easing(he.Quadratic.Out).onUpdate(()=>{null==n||n.scale.set(o.x,o.x,o.x)}).start()}spherical(n){let s=2*Math.random()-1,i=2*Math.random()-1,r=Math.pow(s,2)+Math.pow(i,2);for(;r>1;)s=2*Math.random()-1,i=2*Math.random()-1,r=Math.pow(s,2)+Math.pow(i,2);return{x:n*(2*s*Math.sqrt(1-r)),y:n*(2*i*Math.sqrt(1-r)),z:n*(1-2*r)}}ngOnDestroy(){cancelAnimationFrame(this.request)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-m2"]],viewQuery:function(n,s){if(1&n&&g.Gf(ns,5),2&n){let i;g.iGM(i=g.CRH())&&(s.container=i.first)}},decls:2,vars:0,consts:[["container",""]],template:function(n,s){1&n&&g._UZ(0,"div",null,0)},encapsulation:2}),t})();var zt=ae(383);const is=["container"];let rs=(()=>{class t{constructor(){this.treenum=128,this.eattingnum=0}ngOnInit(){}ngAfterViewInit(){this.initScene()}initScene(){var n;const s=new u.xsS,i=new u.cPb(50,window.innerWidth/window.innerHeight,.1,1e3);i.position.set(0,10,30);const r=new u.CP7;r.setSize(window.innerWidth,window.innerHeight),r.setClearColor(8042478,1),r.shadowMap.enabled=!0,r.shadowMap.type=u.ntZ,null===(n=this.container)||void 0===n||n.nativeElement.appendChild(r.domElement),s.fog=new u.ybr(8042478,0,200);let o=10;const c=new u.xo$(o,60,60),a=new u.xoR({color:5800016}),l=new u.Kj0(c,a);l.receiveShadow=!0,s.add(l);const f=new u.ZAu;s.add(f);const h=new u.vBJ({color:9000270}),d=new u.xoR({color:5800016});let y=[],v=(F,G,H)=>{const Z=new u.ZAu;Z.scale.set(.1,.1,.1),f.add(Z);const W=new u.DvJ(.2,.2,1),$=new u.Kj0(W,h);$.position.set(0,0,-.5),$.castShadow=!0,Z.add($);const C=new u.b_z(.6+.6*Math.random()-.3,1,6),k=new u.Kj0(C,d);k.position.set(0,0,-1.5),k.rotateX(-Math.PI/2),k.castShadow=!0,Z.add(k),this.tweenScale(Z,.1,1,2e3),Z.position.set(F,G,H),Z.lookAt(new u.Pa4(0,0,0)),y.push(Z)};r.render(s,i);const m=new Re.z(i,r.domElement);m.minDistance=14,m.autoRotate=!0,m.autoRotateSpeed=.5;const w=new u.Ox3(16777215);w.position.set(10,10,10),w.castShadow=!0,w.shadow.camera.near=.1,w.shadow.camera.far=200,w.shadow.camera.left=-50,w.shadow.camera.right=50,w.shadow.camera.top=50,w.shadow.camera.bottom=-50,w.shadow.mapSize.width=1024,w.shadow.mapSize.height=1024,s.add(w);const T=new u.Mig(4473924,1);s.add(T);const _=new u.PMe(16777215,1);_.position.set(-20,-20,-20),_.castShadow=!0,_.shadow.mapSize.width=1024,_.shadow.mapSize.height=1024,s.add(_);const S=()=>{this.request=requestAnimationFrame(S),i.aspect=window.innerWidth/window.innerHeight,i.updateProjectionMatrix(),r.setSize(window.innerWidth,window.innerHeight),r.render(s,i),Ze(),m.update()};S();let A=0,b=setInterval(()=>{const F=this.spherical(o);v(F.x,F.y,F.z),A++,A>this.treenum&&clearInterval(b)},200);const M=new zt.L,x=new u.Aip(.5,32,32);let P=new u.xoR({color:5808208});const N=new u.xoR({color:16744448}),D=new u.Kj0(x,N),E=this.spherical(o),I=this.uvToxyz(E.u,E.v,o);D.position.set(I[0],I[1],I[2]),s.add(D);const U=1/12266;let L=0,R=[];for(let F=0;F<12;F++){const G=new u.Kj0(x,P);G.castShadow=!0,f.add(G),R.push(G)}setInterval(()=>{L+=1;const F=(1+.3*Math.sin(11227*L)+Math.sin(3*L/103)+Math.sin(L/171))*Math.PI*M.noise4d(D.position.x*U,D.position.y*U,D.position.z*U,.07);E.u+=1*Math.sin(F),E.v+=.5*Math.cos(F);let G=this.uvToxyz(E.u,E.v,o);D.position.set(G[0],G[1],G[2]);for(let H=R.length-1;H>0;H--)R[H].position.copy(R[H-1].position);R[0].position.set(G[0],G[1],G[2]),y.forEach(H=>{if(H.position.distanceTo(D.position)<1&&!0===H.visible){this.eattingnum++;const W=this.spherical(o),$=this.uvToxyz(W.u,W.v,o);H.position.set($[0],$[1],$[2]),this.tweenScale(H,.1,1,2e3),H.lookAt(new u.Pa4(0,0,0));const C=new u.Kj0(x,P);C.castShadow=!0,f.add(C),R.push(C)}}),this.eattingnum%10==9&&(P.color.r=(56+Math.floor(this.eattingnum/10))/256)},10)}tweenScale(n,s,i,r){const o={x:s};new je(o).to({x:i},r).easing(he.Quadratic.Out).onUpdate(()=>{null==n||n.scale.set(o.x,o.x,o.x)}).start()}spherical(n){let s=2*Math.random()-1,i=2*Math.random()-1,r=Math.pow(s,2)+Math.pow(i,2);for(;r>1;)s=2*Math.random()-1,i=2*Math.random()-1,r=Math.pow(s,2)+Math.pow(i,2);return{u:180*s,v:90*i,x:n*(2*s*Math.sqrt(1-r)),y:n*(2*i*Math.sqrt(1-r)),z:n*(1-2*r)}}uvToxyz(n,s,i){let r=n*Math.PI/180,o=s*Math.PI/180;return[-i*Math.cos(o)*Math.cos(r),-i*Math.sin(o),i*Math.cos(o)*Math.sin(r)]}ngOnDestroy(){cancelAnimationFrame(this.request)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-m3"]],viewQuery:function(n,s){if(1&n&&g.Gf(is,5),2&n){let i;g.iGM(i=g.CRH())&&(s.container=i.first)}},decls:4,vars:1,consts:[[2,"position","absolute","bottom","10px","left","5px"],["container",""]],template:function(n,s){1&n&&(g.TgZ(0,"span",0),g._uU(1),g.qZA(),g._UZ(2,"div",null,1)),2&n&&(g.xp6(1),g.hij("\u541e\u566c\u5927\u6811\u7684\u6570\u91cf\uff1a",s.eattingnum,""))},encapsulation:2}),t})();const os=["container"];let as=(()=>{class t{constructor(){this.scene=new u.xsS}ngOnInit(){}ngAfterViewInit(){this.initScene()}initScene(){var n;const s=this.scene,i=new u.cPb(50,window.innerWidth/window.innerHeight,.1,1e3);i.position.set(0,10,30);const r=new u.CP7;r.setSize(window.innerWidth,window.innerHeight),r.setClearColor(8042478,1),r.render(s,i),null===(n=this.container)||void 0===n||n.nativeElement.appendChild(r.domElement),s.fog=new u.ybr(8042478,0,200),s.add(new u.VLJ(20,10)),new Re.z(i,r.domElement).minDistance=14;const c=new u.Ox3(16777215,1);c.position.set(1,1,1),s.add(c);const a=new u.Mig(4473924,3);s.add(a);const l=()=>{this.request=requestAnimationFrame(l),i.aspect=window.innerWidth/window.innerHeight,i.updateProjectionMatrix(),r.setSize(window.innerWidth,window.innerHeight),r.render(s,i)};l(),(new St).load("assets/models/steve/scene.gltf",h=>{s.add(h.scene),h.scene.scale.set(.2,.2,.2),h.scene.position.set(0,3.2,0)})}addMesh(){const n=this.scene,s=new u.ZAu;n.add(s);const r=new u.nvb(1,1,1),o=new u.xoR({color:5800016}),c=new u.Kj0(r,o);c.position.set(0,0,0),s.add(c)}ngOnDestroy(){cancelAnimationFrame(this.request)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-m4"]],viewQuery:function(n,s){if(1&n&&g.Gf(os,5),2&n){let i;g.iGM(i=g.CRH())&&(s.container=i.first)}},decls:2,vars:0,consts:[["container",""]],template:function(n,s){1&n&&g._UZ(0,"div",null,0)},encapsulation:2}),t})();var ut=ae(8239);class ls extends u.xsS{constructor(){super();const e=new u.DvJ;e.deleteAttribute("uv");const n=new u.Wid({side:u._Li}),s=new u.Wid,i=new u.cek(16777215,5,28,2);i.position.set(.418,16.199,.3),this.add(i);const r=new u.Kj0(e,n);r.position.set(-.757,13.219,.717),r.scale.set(31.713,28.305,28.591),this.add(r);const o=new u.Kj0(e,s);o.position.set(-10.906,2.009,1.846),o.rotation.set(0,-.195,0),o.scale.set(2.328,7.905,4.651),this.add(o);const c=new u.Kj0(e,s);c.position.set(-5.607,-.754,-.758),c.rotation.set(0,.994,0),c.scale.set(1.97,1.534,3.955),this.add(c);const a=new u.Kj0(e,s);a.position.set(6.167,.857,7.803),a.rotation.set(0,.561,0),a.scale.set(3.927,6.285,3.687),this.add(a);const l=new u.Kj0(e,s);l.position.set(-2.017,.018,6.124),l.rotation.set(0,.333,0),l.scale.set(2.002,4.566,2.064),this.add(l);const f=new u.Kj0(e,s);f.position.set(2.291,-.756,-2.621),f.rotation.set(0,-.286,0),f.scale.set(1.546,1.552,1.496),this.add(f);const h=new u.Kj0(e,s);h.position.set(-2.193,-.369,-5.547),h.rotation.set(0,.516,0),h.scale.set(3.875,3.487,2.986),this.add(h);const d=new u.Kj0(e,xe(50));d.position.set(-16.116,14.37,8.208),d.scale.set(.1,2.428,2.739),this.add(d);const p=new u.Kj0(e,xe(50));p.position.set(-16.109,18.021,-8.207),p.scale.set(.1,2.425,2.751),this.add(p);const y=new u.Kj0(e,xe(17));y.position.set(14.904,12.198,-1.832),y.scale.set(.15,4.265,6.331),this.add(y);const v=new u.Kj0(e,xe(43));v.position.set(-.462,8.89,14.52),v.scale.set(4.38,5.441,.088),this.add(v);const m=new u.Kj0(e,xe(20));m.position.set(3.235,11.486,-12.541),m.scale.set(2.5,2,.1),this.add(m);const w=new u.Kj0(e,xe(100));w.position.set(0,20,0),w.scale.set(1,.1,1),this.add(w)}}function xe(t){const e=new u.vBJ;return e.color.setScalar(t),e}var ft=function(t){return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};try{URL.revokeObjectURL(ft(""))}catch(t){ft=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)}}var z=Uint8Array,q=Uint16Array,le=Uint32Array,Me=new z([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Te=new z([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Oe=new z([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ht=function(t,e){for(var n=new q(31),s=0;s<31;++s)n[s]=e+=1<<t[s-1];var i=new le(n[30]);for(s=1;s<30;++s)for(var r=n[s];r<n[s+1];++r)i[r]=r-n[s]<<5|s;return[n,i]},jt=Ht(Me,2),Be=jt[1];jt[0][28]=258,Be[258]=28;for(var pt=Ht(Te,0)[1],Ue=new q(32768),B=0;B<32768;++B){var pe=(43690&B)>>>1|(21845&B)<<1;Ue[B]=((65280&(pe=(61680&(pe=(52428&pe)>>>2|(13107&pe)<<2))>>>4|(3855&pe)<<4))>>>8|(255&pe)<<8)>>>1}var ie=function(t,e,n){for(var s=t.length,i=0,r=new q(e);i<s;++i)++r[t[i]-1];var c,o=new q(e);for(i=0;i<e;++i)o[i]=o[i-1]+r[i-1]<<1;if(n){c=new q(1<<e);var a=15-e;for(i=0;i<s;++i)if(t[i])for(var l=i<<4|t[i],f=e-t[i],h=o[t[i]-1]++<<f,d=h|(1<<f)-1;h<=d;++h)c[Ue[h]>>>a]=l}else for(c=new q(s),i=0;i<s;++i)t[i]&&(c[i]=Ue[o[t[i]-1]++]>>>15-t[i]);return c},de=new z(288);for(B=0;B<144;++B)de[B]=8;for(B=144;B<256;++B)de[B]=9;for(B=256;B<280;++B)de[B]=7;for(B=280;B<288;++B)de[B]=8;var Pe=new z(32);for(B=0;B<32;++B)Pe[B]=5;var Kt=ie(de,9,0),Vt=ie(Pe,5,0),De=function(t){return(t/8|0)+(7&t&&1)},me=function(t,e,n){(null==e||e<0)&&(e=0),(null==n||n>t.length)&&(n=t.length);var s=new(t instanceof q?q:t instanceof le?le:z)(n-e);return s.set(t.subarray(e,n)),s},re=function(t,e,n){var s=e/8|0;t[s]|=n<<=7&e,t[s+1]|=n>>>8},Ae=function(t,e,n){var s=e/8|0;t[s]|=n<<=7&e,t[s+1]|=n>>>8,t[s+2]|=n>>>16},qe=function(t,e){for(var n=[],s=0;s<t.length;++s)t[s]&&n.push({s,f:t[s]});var i=n.length,r=n.slice();if(!i)return[Xe,0];if(1==i){var o=new z(n[0].s+1);return o[n[0].s]=1,[o,1]}n.sort(function(A,b){return A.f-b.f}),n.push({s:-1,f:25001});var c=n[0],a=n[1],l=0,f=1,h=2;for(n[0]={s:-1,f:c.f+a.f,l:c,r:a};f!=i-1;)c=n[n[l].f<n[h].f?l++:h++],a=n[l!=f&&n[l].f<n[h].f?l++:h++],n[f++]={s:-1,f:c.f+a.f,l:c,r:a};var d=r[0].s;for(s=1;s<i;++s)r[s].s>d&&(d=r[s].s);var p=new q(d+1),y=We(n[f-1],p,0);if(y>e){s=0;var v=0,m=y-e,w=1<<m;for(r.sort(function(b,M){return p[M.s]-p[b.s]||b.f-M.f});s<i;++s){var T=r[s].s;if(!(p[T]>e))break;v+=w-(1<<y-p[T]),p[T]=e}for(v>>>=m;v>0;){var _=r[s].s;p[_]<e?v-=1<<e-p[_]++-1:++s}for(;s>=0&&v;--s){var S=r[s].s;p[S]==e&&(--p[S],++v)}y=e}return[new z(p),y]},We=function(t,e,n){return-1==t.s?Math.max(We(t.l,e,n+1),We(t.r,e,n+1)):e[t.s]=n},dt=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new q(++e),s=0,i=t[0],r=1,o=function(a){n[s++]=a},c=1;c<=e;++c)if(t[c]==i&&c!=e)++r;else{if(!i&&r>2){for(;r>138;r-=138)o(32754);r>2&&(o(r>10?r-11<<5|28690:r-3<<5|12305),r=0)}else if(r>3){for(o(i),--r;r>6;r-=6)o(8304);r>2&&(o(r-3<<5|8208),r=0)}for(;r--;)o(i);r=1,i=t[c]}return[n.subarray(0,s),e]},be=function(t,e){for(var n=0,s=0;s<e.length;++s)n+=t[s]*e[s];return n},Fe=function(t,e,n){var s=n.length,i=De(e+2);t[i]=255&s,t[i+1]=s>>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var r=0;r<s;++r)t[i+r+4]=n[r];return 8*(i+4+s)},mt=function(t,e,n,s,i,r,o,c,a,l,f){re(e,f++,n),++i[256];for(var h=qe(i,15),d=h[0],p=h[1],y=qe(r,15),v=y[0],m=y[1],w=dt(d),T=w[0],_=w[1],S=dt(v),A=S[0],b=S[1],M=new q(19),x=0;x<T.length;++x)M[31&T[x]]++;for(x=0;x<A.length;++x)M[31&A[x]]++;for(var P=qe(M,7),N=P[0],D=P[1],E=19;E>4&&!N[Oe[E-1]];--E);var R,j,F,G,I=l+5<<3,U=be(i,de)+be(r,Pe)+o,L=be(i,d)+be(r,v)+o+14+3*E+be(M,N)+(2*M[16]+3*M[17]+7*M[18]);if(I<=U&&I<=L)return Fe(e,f,t.subarray(a,a+l));if(re(e,f,1+(L<U)),f+=2,L<U){R=ie(d,p,0),j=d,F=ie(v,m,0),G=v;var H=ie(N,D,0);for(re(e,f,_-257),re(e,f+5,b-1),re(e,f+10,E-4),f+=14,x=0;x<E;++x)re(e,f+3*x,N[Oe[x]]);f+=3*E;for(var Z=[T,A],W=0;W<2;++W){var $=Z[W];for(x=0;x<$.length;++x)re(e,f,H[C=31&$[x]]),f+=N[C],C>15&&(re(e,f,$[x]>>>5&127),f+=$[x]>>>12)}}else R=Kt,j=de,F=Vt,G=Pe;for(x=0;x<c;++x)if(s[x]>255){var C;Ae(e,f,R[257+(C=s[x]>>>18&31)]),f+=j[C+257],C>7&&(re(e,f,s[x]>>>23&31),f+=Me[C]);var k=31&s[x];Ae(e,f,F[k]),f+=G[k],k>3&&(Ae(e,f,s[x]>>>5&8191),f+=Te[k])}else Ae(e,f,R[s[x]]),f+=j[s[x]];return Ae(e,f,R[256]),f+j[256]},Wt=new le([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Xe=new z(0),Jt=function(){for(var t=new le(256),e=0;e<256;++e){for(var n=e,s=9;--s;)n=(1&n&&3988292384)^n>>>1;t[e]=n}return t}(),Je=function(){var t=-1;return{p:function(e){for(var n=t,s=0;s<e.length;++s)n=Jt[255&n^e[s]]^n>>>8;t=n},d:function(){return~t}}},Qe=function(t,e,n,s,i){return function(t,e,n,s,i,r){var o=t.length,c=new z(s+o+5*(1+Math.ceil(o/7e3))+i),a=c.subarray(s,c.length-i),l=0;if(!e||o<8)for(var f=0;f<=o;f+=65535){var h=f+65535;h<o?l=Fe(a,l,t.subarray(f,h)):(a[f]=r,l=Fe(a,l,t.subarray(f,o)))}else{for(var d=Wt[e-1],p=d>>>13,y=8191&d,v=(1<<n)-1,m=new q(32768),w=new q(v+1),T=Math.ceil(n/3),_=2*T,S=function(At){return(t[At]^t[At+1]<<T^t[At+2]<<_)&v},A=new le(25e3),b=new q(288),M=new q(32),x=0,P=0,N=(f=0,0),D=0,E=0;f<o;++f){var I=S(f),U=32767&f,L=w[I];if(m[U]=L,w[I]=U,D<=f){var R=o-f;if((x>7e3||N>24576)&&R>423){l=mt(t,a,0,A,b,M,P,N,E,f-E,l),N=x=P=0,E=f;for(var j=0;j<286;++j)b[j]=0;for(j=0;j<30;++j)M[j]=0}var F=2,G=0,H=y,Z=U-L&32767;if(R>2&&I==S(f-Z))for(var W=Math.min(p,R)-1,$=Math.min(32767,f),C=Math.min(258,R);Z<=$&&--H&&U!=L;){if(t[f+F]==t[f+F-Z]){for(var k=0;k<C&&t[f+k]==t[f+k-Z];++k);if(k>F){if(F=k,G=Z,k>W)break;var V=Math.min(Z,k-2),J=0;for(j=0;j<V;++j){var Q=f-Z+j+32768&32767,oe=Q-m[Q]+32768&32767;oe>J&&(J=oe,L=Q)}}}Z+=(U=L)-(L=m[U])+32768&32767}if(G){A[N++]=268435456|Be[F]<<18|pt[G];var ue=31&Be[F],te=31&pt[G];P+=Me[ue]+Te[te],++b[257+ue],++M[te],D=f+F,++x}else A[N++]=t[f],++b[t[f]]}}l=mt(t,a,r,A,b,M,P,N,E,f-E,l),!r&&7&l&&(l=Fe(a,l+1,Xe))}return me(c,0,s+De(l)+i)}(t,null==e.level?6:e.level,null==e.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+e.mem,n,s,!i)},Ye=function(t,e){var n={};for(var s in t)n[s]=t[s];for(var s in e)n[s]=e[s];return n},K=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8};function tt(t,e){return Qe(t,e||{},0,0)}var Mt=function(t,e,n,s){for(var i in t){var r=t[i],o=e+i;r instanceof z?n[o]=[r,s]:Array.isArray(r)?n[o]=[r[0],Ye(s,r[1])]:Mt(r,o+"/",n,s)}},fn="undefined"!=typeof TextEncoder&&new TextEncoder,Tt="undefined"!=typeof TextDecoder&&new TextDecoder;try{Tt.decode(Xe,{stream:!0})}catch(t){}function Ee(t,e){if(e){for(var n=new z(t.length),s=0;s<t.length;++s)n[s]=t.charCodeAt(s);return n}if(fn)return fn.encode(t);var i=t.length,r=new z(t.length+(t.length>>1)),o=0,c=function(f){r[o++]=f};for(s=0;s<i;++s){if(o+5>r.length){var a=new z(o+8+(i-s<<1));a.set(r),r=a}var l=t.charCodeAt(s);l<128||e?c(l):l<2048?(c(192|l>>6),c(128|63&l)):l>55295&&l<57344?(c(240|(l=65536+(1047552&l)|1023&t.charCodeAt(++s))>>18),c(128|l>>12&63),c(128|l>>6&63),c(128|63&l)):(c(224|l>>12),c(128|l>>6&63),c(128|63&l))}return me(r,0,o)}var Ne=function(t){var e=0;if(t)for(var n in t){var s=t[n].length;if(s>65535)throw"extra field too long";e+=s+4}return e},nt=function(t,e,n,s,i,r,o,c){var a=s.length,l=n.extra,f=c&&c.length,h=Ne(l);K(t,e,null!=o?33639248:67324752),e+=4,null!=o&&(t[e++]=20,t[e++]=n.os),t[e]=20,e+=2,t[e++]=n.flag<<1|(null==r&&8),t[e++]=i&&8,t[e++]=255&n.compression,t[e++]=n.compression>>8;var d=new Date(null==n.mtime?Date.now():n.mtime),p=d.getFullYear()-1980;if(p<0||p>119)throw"date not in range 1980-2099";if(K(t,e,p<<25|d.getMonth()+1<<21|d.getDate()<<16|d.getHours()<<11|d.getMinutes()<<5|d.getSeconds()>>>1),e+=4,null!=r&&(K(t,e,n.crc),K(t,e+4,r),K(t,e+8,n.size)),K(t,e+12,a),K(t,e+14,h),e+=16,null!=o&&(K(t,e,f),K(t,e+6,n.attrs),K(t,e+10,o),e+=14),t.set(s,e),e+=a,h)for(var y in l){var v=l[y],m=v.length;K(t,e,+y),K(t,e+2,m),t.set(v,e+4),e+=4+m}return f&&(t.set(c,e),e+=f),e};class As{parse(e){return(0,ut.Z)(function*(){const n={},s="model.usda";n[s]=null;let i='#usda 1.0\n(\n    customLayerData = {\n        string creator = "Three.js USDZExporter"\n    }\n    metersPerUnit = 1\n    upAxis = "Y"\n)\n\n';const r={},o={};e.traverseVisible(a=>{if(a.isMesh)if(a.material.isMeshStandardMaterial){const l=a.geometry,f=a.material,h="geometries/Geometry_"+l.id+".usd";if(!(h in n)){const d=function(t){return`\ndef "Geometry"\n{\n  ${function(t){const n=t.attributes,s=n.position.count;return`\n    def Mesh "Geometry"\n    {\n        int[] faceVertexCounts = [${function(t){return Array((null!==t.index?t.index.count:t.attributes.position.count)/3).fill(3).join(", ")}(t)}]\n        int[] faceVertexIndices = [${function(t){const e=t.index,n=[];if(null!==e)for(let s=0;s<e.count;s++)n.push(e.getX(s));else{const s=t.attributes.position.count;for(let i=0;i<s;i++)n.push(i)}return n.join(", ")}(t)}]\n        normal3f[] normals = [${gn(n.normal,s)}] (\n            interpolation = "vertex"\n        )\n        point3f[] points = [${gn(n.position,s)}]\n        float2[] primvars:st = [${function(t,e){if(void 0===t)return console.warn("USDZExporter: UVs missing."),Array(e).fill("(0, 0)").join(", ");const n=[];for(let s=0;s<t.count;s++){const i=t.getX(s),r=t.getY(s);n.push(`(${i.toPrecision(7)}, ${1-r.toPrecision(7)})`)}return n.join(", ")}(n.uv,s)}] (\n            interpolation = "vertex"\n        )\n        uniform token subdivisionScheme = "none"\n    }\n`}(t)}\n}\n`}(l);n[h]=function(t){let e='#usda 1.0\n(\n    customLayerData = {\n        string creator = "Three.js USDZExporter"\n    }\n    metersPerUnit = 1\n    upAxis = "Y"\n)\n\n';return e+=t,Ee(e)}(d)}f.uuid in r||(r[f.uuid]=f),i+=function(t,e,n){const s="Object_"+t.id,i=function(t){const e=t.elements;return`( ${st(e,0)}, ${st(e,4)}, ${st(e,8)}, ${st(e,12)} )`}(t.matrixWorld);return t.matrixWorld.determinant()<0&&console.warn("THREE.USDZExporter: USDZ does not support negative scales",t),`def Xform "${s}" (\n    prepend references = @./geometries/Geometry_${e.id}.usd@</Geometry>\n)\n{\n    matrix4d xformOp:transform = ${i}\n    uniform token[] xformOpOrder = ["xformOp:transform"]\n\n    rel material:binding = </Materials/Material_${n.id}>\n}\n\n`}(a,l,f)}else console.warn("THREE.USDZExporter: Unsupported material type (USDZ only supports MeshStandardMaterial)",a)}),i+=function(t,e){const n=[];for(const s in t)n.push(Ps(t[s],e));return`def "Materials"\n{\n${n.join("")}\n}\n\n`}(r,o),n[s]=Ee(i),i=null;for(const a in o){const l=o[a],f=a.split("_")[1],h=1023===l.format,d=bs(l.image,f),p=yield new Promise(y=>d.toBlob(y,h?"image/png":"image/jpeg",1));n[`textures/Texture_${a}.${h?"png":"jpg"}`]=new Uint8Array(yield p.arrayBuffer())}let c=0;for(const a in n){const l=n[a];c+=34+a.length;const h=63&c;if(4!==h){const p=new Uint8Array(64-h);n[a]=[l,{extra:{12345:p}}]}c=l.length}return function(t,e){e||(e={});var n={},s=[];Mt(t,"",n,e);var i=0,r=0;for(var o in n){var c=n[o],a=c[0],l=c[1],f=0==l.level?0:8,d=(h=Ee(o)).length,p=l.comment,y=p&&Ee(p),v=y&&y.length,m=Ne(l.extra);if(d>65535)throw"filename too long";var w=f?tt(a,l):a,T=w.length,_=Je();_.p(a),s.push(Ye(l,{size:a.length,crc:_.d(),c:w,f:h,m:y,u:d!=o.length||y&&p.length!=v,o:i,compression:f})),i+=30+d+m+T,r+=76+2*(d+m)+(v||0)+T}for(var S=new z(r+22),A=i,b=r-i,M=0;M<s.length;++M){var h;nt(S,(h=s[M]).o,h,h.f,h.u,h.c.length);var x=30+h.f.length+Ne(h.extra);S.set(h.c,h.o+x),nt(S,i,h,h.f,h.u,h.c.length,h.o,h.m),i+=16+x+(h.m?h.m.length:0)}return function(t,e,n,s,i){K(t,e,101010256),K(t,e+8,n),K(t,e+10,n),K(t,e+12,s),K(t,e+16,i)}(S,i,s.length,b,A),S}(n,{level:0})})()}}function bs(t,e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const n=1024/Math.max(t.width,t.height),s=document.createElement("canvas");s.width=t.width*Math.min(1,n),s.height=t.height*Math.min(1,n);const i=s.getContext("2d");if(i.drawImage(t,0,0,s.width,s.height),void 0!==e){const r=parseInt(e,16),o=(r>>16&255)/255,c=(r>>8&255)/255,a=(255&r)/255,l=i.getImageData(0,0,s.width,s.height),f=l.data;for(let h=0;h<f.length;h+=4)f[h+0]=f[h+0]*o,f[h+1]=f[h+1]*c,f[h+2]=f[h+2]*a;i.putImageData(l,0,0)}return s}}function st(t,e){return`(${t[e+0]}, ${t[e+1]}, ${t[e+2]}, ${t[e+3]})`}function gn(t,e){if(void 0===t)return console.warn("USDZExporter: Normals missing."),Array(e).fill("(0, 0, 0)").join(", ");const n=[];for(let s=0;s<t.count;s++){const i=t.getX(s),r=t.getY(s),o=t.getZ(s);n.push(`(${i.toPrecision(7)}, ${r.toPrecision(7)}, ${o.toPrecision(7)})`)}return n.join(", ")}function Ps(t,e){const n="            ",s=[],i=[];function r(o,c,a){const l=o.id+(a?"_"+a.getHexString():""),f=1023===o.format;return e[l]=o,`\n        def Shader "Transform2d_${c}" (\n            sdrMetadata = {\n                string role = "math"\n            }\n        )\n        {\n            uniform token info:id = "UsdTransform2d"\n            float2 inputs:in.connect = </Materials/Material_${t.id}/uvReader_st.outputs:result>\n            float2 inputs:scale = ${wn(o.repeat)}\n            float2 inputs:translation = ${wn(o.offset)}\n            float2 outputs:result\n        }\n\n        def Shader "Texture_${o.id}_${c}"\n        {\n            uniform token info:id = "UsdUVTexture"\n            asset inputs:file = @textures/Texture_${l}.${f?"png":"jpg"}@\n            float2 inputs:st.connect = </Materials/Material_${t.id}/Transform2d_${c}.outputs:result>\n            token inputs:wrapS = "repeat"\n            token inputs:wrapT = "repeat"\n            float outputs:r\n            float outputs:g\n            float outputs:b\n            float3 outputs:rgb\n        }`}return null!==t.map?(s.push(`${n}color3f inputs:diffuseColor.connect = </Materials/Material_${t.id}/Texture_${t.map.id}_diffuse.outputs:rgb>`),i.push(r(t.map,"diffuse",t.color))):s.push(`${n}color3f inputs:diffuseColor = ${vn(t.color)}`),null!==t.emissiveMap?(s.push(`${n}color3f inputs:emissiveColor.connect = </Materials/Material_${t.id}/Texture_${t.emissiveMap.id}_emissive.outputs:rgb>`),i.push(r(t.emissiveMap,"emissive"))):t.emissive.getHex()>0&&s.push(`${n}color3f inputs:emissiveColor = ${vn(t.emissive)}`),null!==t.normalMap&&(s.push(`${n}normal3f inputs:normal.connect = </Materials/Material_${t.id}/Texture_${t.normalMap.id}_normal.outputs:rgb>`),i.push(r(t.normalMap,"normal"))),null!==t.aoMap&&(s.push(`${n}float inputs:occlusion.connect = </Materials/Material_${t.id}/Texture_${t.aoMap.id}_occlusion.outputs:r>`),i.push(r(t.aoMap,"occlusion"))),null!==t.roughnessMap&&1===t.roughness?(s.push(`${n}float inputs:roughness.connect = </Materials/Material_${t.id}/Texture_${t.roughnessMap.id}_roughness.outputs:g>`),i.push(r(t.roughnessMap,"roughness"))):s.push(`${n}float inputs:roughness = ${t.roughness}`),null!==t.metalnessMap&&1===t.metalness?(s.push(`${n}float inputs:metallic.connect = </Materials/Material_${t.id}/Texture_${t.metalnessMap.id}_metallic.outputs:b>`),i.push(r(t.metalnessMap,"metallic"))):s.push(`${n}float inputs:metallic = ${t.metalness}`),null!==t.alphaMap?(s.push(`${n}float inputs:opacity.connect = </Materials/Material_${t.id}/Texture_${t.alphaMap.id}_opacity.outputs:r>`),s.push(`${n}float inputs:opacityThreshold = 0.0001`),i.push(r(t.alphaMap,"opacity"))):s.push(`${n}float inputs:opacity = ${t.opacity}`),t.isMeshPhysicalMaterial&&(s.push(`${n}float inputs:clearcoat = ${t.clearcoat}`),s.push(`${n}float inputs:clearcoatRoughness = ${t.clearcoatRoughness}`),s.push(`${n}float inputs:ior = ${t.ior}`)),`\n    def Material "Material_${t.id}"\n    {\n        def Shader "PreviewSurface"\n        {\n            uniform token info:id = "UsdPreviewSurface"\n${s.join("\n")}\n            int inputs:useSpecularWorkflow = 0\n            token outputs:surface\n        }\n\n        token outputs:surface.connect = </Materials/Material_${t.id}/PreviewSurface.outputs:surface>\n        token inputs:frame:stPrimvarName = "st"\n\n        def Shader "uvReader_st"\n        {\n            uniform token info:id = "UsdPrimvarReader_float2"\n            token inputs:varname.connect = </Materials/Material_${t.id}.inputs:frame:stPrimvarName>\n            float2 inputs:fallback = (0.0, 0.0)\n            float2 outputs:result\n        }\n\n${i.join("\n")}\n\n    }\n`}function vn(t){return`(${t.r}, ${t.g}, ${t.b})`}function wn(t){return`(${t.x}, ${t.y})`}const Ds=["container"],Fs=[{path:"",component:xn,children:[{path:"m1",component:Wn},{path:"m2",component:ss},{path:"m3",component:rs},{path:"m4",component:as},{path:"m5",component:(()=>{class t{constructor(){this.treenum=128,this.eattingnum=0,this.scene=new u.xsS}ngOnInit(){}ngAfterViewInit(){this.initScene()}initScene(){var n;const s=this.scene,i=new u.cPb(50,window.innerWidth/window.innerHeight,.1,1e3);i.position.set(0,10,30);const r=new u.CP7;r.setSize(window.innerWidth,window.innerHeight),r.setClearColor(8042478,1),r.render(s,i),null===(n=this.container)||void 0===n||n.nativeElement.appendChild(r.domElement),s.fog=new u.ybr(8042478,0,200);let o=10;const c=new u.xo$(o,60,60),a=new u.xoR({color:5800016}),l=new u.Kj0(c,a);l.receiveShadow=!0,s.add(l);const f=new u.ZAu;s.add(f);const h=new u.vBJ({color:9000270}),d=new u.xoR({color:5800016});let y=[],v=(C,k,V)=>{const J=new u.ZAu;J.scale.set(.1,.1,.1),f.add(J);const Q=new u.DvJ(.2,.2,1),Y=new u.Kj0(Q,h);Y.position.set(0,0,-.5),Y.castShadow=!0,J.add(Y);const oe=new u.b_z(.6+.6*Math.random()-.3,1,6),ue=new u.Kj0(oe,d);ue.position.set(0,0,-1.5),ue.rotateX(-Math.PI/2),ue.castShadow=!0,J.add(ue),this.tweenScale(J,.1,1,2e3),J.position.set(C,k,V),J.lookAt(new u.Pa4(0,0,0)),y.push(J)};const m=new Re.z(i,r.domElement);m.minDistance=14,m.autoRotate=!0,m.autoRotateSpeed=.5;const w=new u.Ox3(16777215);w.position.set(10,10,10),w.castShadow=!0,w.shadow.camera.near=.1,w.shadow.camera.far=200,w.shadow.camera.left=-50,w.shadow.camera.right=50,w.shadow.camera.top=50,w.shadow.camera.bottom=-50,w.shadow.mapSize.width=1024,w.shadow.mapSize.height=1024,s.add(w);const T=new u.Mig(4473924,1);s.add(T);const _=new u.PMe(16777215,1);_.position.set(-20,-20,-20),_.castShadow=!0,_.shadow.mapSize.width=1024,_.shadow.mapSize.height=1024,s.add(_);const S=()=>{this.request=requestAnimationFrame(S),i.aspect=window.innerWidth/window.innerHeight,i.updateProjectionMatrix(),r.setSize(window.innerWidth,window.innerHeight),r.render(s,i),Ze(),m.update()};S();let A=0,b=setInterval(()=>{const C=this.spherical(o);v(C.x,C.y,C.z),A++,A>this.treenum&&clearInterval(b)},200);const M=new zt.L,x=new u.Aip(.5,32,32);let P=new u.xoR({color:5808208});const N=new u.xoR({color:16744448}),D=new u.Kj0(x,N),E=this.spherical(o),I=this.uvToxyz(E.u,E.v,o);D.position.set(I[0],I[1],I[2]),s.add(D);const U=1/12266;let L=0,R=[];for(let C=0;C<12;C++){const k=new u.Kj0(x,P);k.castShadow=!0,f.add(k),R.push(k)}setInterval(()=>{L+=1;const C=(1+.3*Math.sin(11227*L)+Math.sin(3*L/103)+Math.sin(L/171))*Math.PI*M.noise4d(D.position.x*U,D.position.y*U,D.position.z*U,.07);E.u+=1*Math.sin(C),E.v+=.5*Math.cos(C);let k=this.uvToxyz(E.u,E.v,o);D.position.set(k[0],k[1],k[2]);for(let V=R.length-1;V>0;V--)R[V].position.copy(R[V-1].position);R[0].position.set(k[0],k[1],k[2]),y.forEach(V=>{if(V.position.distanceTo(D.position)<1&&!0===V.visible){this.eattingnum++;const Q=this.spherical(o),Y=this.uvToxyz(Q.u,Q.v,o);V.position.set(Y[0],Y[1],Y[2]),this.tweenScale(V,.1,1,2e3),V.lookAt(new u.Pa4(0,0,0));const oe=new u.Kj0(x,P);oe.castShadow=!0,f.add(oe),R.push(oe)}}),this.eattingnum%10==9&&(P.color.r=(56+Math.floor(this.eattingnum/10))/256)},10);const F=new u.nvb(1,1,1),G=new u.Wid({color:"red"}),H=new u.Kj0(F,G);s.add(H),H.position.set(0,0,-.5),H.scale.set(.1,.1,.1);const $=navigator.userAgent;$.indexOf("iPhone")>-1||$.indexOf("Mac")>-1?(()=>{var C;const k=new u.anP(r);s.environment=k.fromScene(new ls,.04).texture;const V=new As,J=null===(C=this.container)||void 0===C?void 0:C.nativeElement;function Y(){return(Y=(0,ut.Z)(function*(){const oe=yield V.parse(l),ue=new Blob([oe],{type:"application/octet-stream"}),te=document.createElement("a");te.id="link",te.href="",te.download="asset.usdz",J.appendChild(te);const it=document.createElement("img");it.id="button",it.style.width="100px",it.src="assets/images/arkit.png",te.appendChild(it),te.style.position="absolute",te.style.bottom="15px",te.style.left="calc(50%-40px)",te.href=URL.createObjectURL(ue)})).apply(this,arguments)}!function(){Y.apply(this,arguments)}()})():(()=>{r.xr.enabled=!0,document.body.appendChild(class{static createButton(e,n={}){const s=document.createElement("button");function o(){s.style.display="",s.style.cursor="auto",s.style.left="calc(50% - 75px)",s.style.width="150px",s.onmouseenter=null,s.onmouseleave=null,s.onclick=null,s.textContent="AR NOT SUPPORTED"}function c(a){a.style.position="absolute",a.style.bottom="20px",a.style.padding="12px 6px",a.style.border="1px solid #fff",a.style.borderRadius="4px",a.style.background="rgba(0,0,0,0.1)",a.style.color="#fff",a.style.font="normal 13px sans-serif",a.style.textAlign="center",a.style.opacity="0.5",a.style.outline="none",a.style.zIndex="999"}if("xr"in navigator)return s.id="ARButton",s.style.display="none",c(s),navigator.xr.isSessionSupported("immersive-ar").then(function(a){a?function(){if(void 0===n.domOverlay){var a=document.createElement("div");a.style.display="none",document.body.appendChild(a);var l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.setAttribute("width",38),l.setAttribute("height",38),l.style.position="absolute",l.style.right="20px",l.style.top="20px",l.addEventListener("click",function(){h.end()}),a.appendChild(l);var f=document.createElementNS("http://www.w3.org/2000/svg","path");f.setAttribute("d","M 12,12 L 28,28 M 28,12 12,28"),f.setAttribute("stroke","#fff"),f.setAttribute("stroke-width",2),l.appendChild(f),void 0===n.optionalFeatures&&(n.optionalFeatures=[]),n.optionalFeatures.push("dom-overlay"),n.domOverlay={root:a}}let h=null;function d(v){return p.apply(this,arguments)}function p(){return(p=(0,ut.Z)(function*(v){v.addEventListener("end",y),e.xr.setReferenceSpaceType("local"),yield e.xr.setSession(v),s.textContent="STOP AR",n.domOverlay.root.style.display="",h=v})).apply(this,arguments)}function y(){h.removeEventListener("end",y),s.textContent="START AR",n.domOverlay.root.style.display="none",h=null}s.style.display="",s.style.cursor="pointer",s.style.left="calc(50% - 50px)",s.style.width="100px",s.textContent="START AR",s.onmouseenter=function(){s.style.opacity="1.0"},s.onmouseleave=function(){s.style.opacity="0.5"},s.onclick=function(){null===h?navigator.xr.requestSession("immersive-ar",n).then(d):h.end()}}():o()}).catch(o),s;{const a=document.createElement("a");return!1===window.isSecureContext?(a.href=document.location.href.replace(/^http:/,"https:"),a.innerHTML="WEBXR NEEDS HTTPS"):(a.href="https://immersiveweb.dev/",a.innerHTML="WEBXR NOT AVAILABLE"),a.style.left="calc(50% - 90px)",a.style.width="180px",a.style.textDecoration="none",c(a),a}}}.createButton(r));const C=r.xr.getController(0);s.add(C)})()}tweenScale(n,s,i,r){const o={x:s};new je(o).to({x:i},r).easing(he.Quadratic.Out).onUpdate(()=>{null==n||n.scale.set(o.x,o.x,o.x)}).start()}spherical(n){let s=2*Math.random()-1,i=2*Math.random()-1,r=Math.pow(s,2)+Math.pow(i,2);for(;r>1;)s=2*Math.random()-1,i=2*Math.random()-1,r=Math.pow(s,2)+Math.pow(i,2);return{u:180*s,v:90*i,x:n*(2*s*Math.sqrt(1-r)),y:n*(2*i*Math.sqrt(1-r)),z:n*(1-2*r)}}uvToxyz(n,s,i){let r=n*Math.PI/180,o=s*Math.PI/180;return[-i*Math.cos(o)*Math.cos(r),-i*Math.sin(o),i*Math.cos(o)*Math.sin(r)]}ngOnDestroy(){cancelAnimationFrame(this.request)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-m5"]],viewQuery:function(n,s){if(1&n&&g.Gf(Ds,5),2&n){let i;g.iGM(i=g.CRH())&&(s.container=i.first)}},decls:4,vars:1,consts:[[2,"position","absolute","bottom","5px","left","5px"],["container",""]],template:function(n,s){1&n&&(g.TgZ(0,"span",0),g._uU(1),g.qZA(),g._UZ(2,"div",null,1)),2&n&&(g.xp6(1),g.hij("\u541e\u566c\u5927\u6811\u7684\u6570\u91cf\uff1a",s.eattingnum,""))},encapsulation:2}),t})()},{path:"m6",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-m6"]],decls:2,vars:0,template:function(n,s){1&n&&(g.TgZ(0,"p"),g._uU(1," m6 works! "),g.qZA())},encapsulation:2}),t})()},{path:"",redirectTo:"m3",pathMatch:"full"},{path:"**",redirectTo:"m3"}]}];let zs=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({imports:[[He.Bz.forChild(Fs)],He.Bz]}),t})(),Ns=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({imports:[[zs,yn.ez]]}),t})()}}]);